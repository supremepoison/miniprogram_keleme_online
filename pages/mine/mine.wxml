<view class="mine-container">
  <view class="logged-out" wx:if="{{!isLoggedIn}}">
    <view class="avatar-placeholder">
      <t-icon name="user" size="96rpx" color="#d1d5db" />
    </view>
    <text class="welcome-title">欢迎来到 AI 画廊</text>
    <text class="welcome-desc">登录后可以保存和分享你的作品</text>
    <t-button
      theme="primary"
      size="large"
      bindtap="onLogin"
      class="login-button"
      icon="logo-wechat"
    >
      微信一键登录
    </t-button>
  </view>

  <view class="logged-in" wx:else>
    <view class="user-profile">
      <view class="profile-header">
        <view class="user-avatar-wrapper">
          <view class="user-avatar">
            <image wx:if="{{userInfo.avatar}}" src="{{userInfo.avatar}}" class="avatar-image" mode="aspectFill" />
            <text wx:else class="avatar-text">AI</text>
          </view>
          <t-icon name="edit" size="32rpx" color="#666" class="avatar-edit-icon" bindtap="onEditAvatar" />
        </view>
        <view class="user-info">
          <text class="user-name" bindtap="onEditNickname">{{userInfo.nickName}}</text>
        </view>
      </view>

      <view class="stats">
        <view class="stat-item">
          <text class="stat-number">{{stats.works}}</text>
          <text class="stat-label">作品</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{stats.likes}}</text>
          <text class="stat-label">获赞</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{stats.favorites}}</text>
          <text class="stat-label">收藏</text>
        </view>
      </view>
    </view>

    <view class="gallery-section">
      <text class="section-title">个人画廊</text>
      <view class="image-grid" wx:if="{{galleryList.length > 0}}">
        <view class="image-card" wx:for="{{galleryList}}" wx:key="id">
          <view wx:if="{{item.imageUrl}}" class="image-wrapper">
            <image
              src="{{item.imageUrl}}"
              mode="aspectFill"
              binderror="onImageError"
              bindload="onImageLoad"
              data-id="{{item.id}}"
            />
          </view>
          <view wx:else class="image-placeholder gradient-1">
            <t-icon name="image" size="96rpx" color="rgba(255, 255, 255, 0.3)" />
          </view>
          <view class="image-info">
            <text class="image-prompt">{{item.prompt}}</text>
            <view class="card-footer">
              <text class="upload-time">{{item.time}}</text>
              <view class="like-info">
                <t-icon name="heart" size="24rpx" color="#999" />
                <text class="like-count">{{item.likes}}</text>
              </view>
            </view>
          </view>
        </view>
      </view>
      <view class="empty-state" wx:else>
        <t-icon name="image" size="96rpx" color="#d1d5db" />
        <text class="empty-text">还没有发布作品</text>
        <text class="empty-desc">快去创作你的第一幅作品吧</text>
      </view>
    </view>

    <view class="logout-section">
      <t-button theme="default" size="large" bindtap="onLogout" class="logout-button">
        退出登录
      </t-button>
    </view>
  </view>
</view>
